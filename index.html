<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ø±Ø­Ù„Ù‡ Û² â€” Ø§Ø´ØªØ±Ø§Ú© (Ø¢Ø²Ù…Ø§ÛŒØ´ ØªØ¹Ø§Ù…Ù„ÛŒ)</title>
<style>
  :root{
    --bg1:#051018; --bg2:#071826;
    --card:#ffffff10; --accent:#62f0ff; --good:#21d07a; --bad:#ff5b6b;
    --glass: rgba(255,255,255,0.04);
  }
  *{ box-sizing:border-box; }
  body{
    margin:0; padding:26px; font-family: Vazirmatn, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    color:#e6f7fb; text-align:center; min-height:100vh;
  }
  h1{ margin:6px 0 12px; font-size:22px; letter-spacing:0.6px; }
  .subtitle{ color:#99f4ff66; margin-bottom:12px; }

  /* layout */
  .top-row{ display:flex; gap:18px; justify-content:center; align-items:center; flex-wrap:wrap; margin-bottom:14px; }
  #scoreBox{ background:var(--glass); padding:10px 14px; border-radius:12px; font-weight:700; color:#aef7ff; }
  #introSmall{ max-width:760px; text-align:center; color:#bff9ff; padding:12px 16px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); box-shadow:0 6px 24px rgba(0,0,0,0.6); }

  .board{ display:flex; gap:18px; justify-content:center; align-items:flex-start; flex-wrap:wrap; margin-top:18px; }

  /* sets */
  .set-box{
    width:300px; min-height:160px; padding:14px; border-radius:14px; background:var(--glass); position:relative;
    border:1px solid rgba(255,255,255,0.04); box-shadow:0 10px 30px rgba(0,0,0,0.55);
    transition:transform .22s ease, box-shadow .22s ease;
  }
  .set-box.highlight{ transform:translateY(-6px); box-shadow:0 18px 44px rgba(0,240,255,0.08); }
  .set-title{ font-weight:900; font-size:18px; margin-bottom:6px; color:#cffcff; letter-spacing:0.6px; }
  .set-rule{ font-size:13px; color:#9deff6; opacity:0.9; margin-bottom:8px; }
  .set-contents{ min-height:70px; display:flex; gap:8px; flex-wrap:wrap; align-items:flex-start; padding:6px; border-radius:8px; background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(255,255,255,0.01)); }
  .set-braces{ position:absolute; right:12px; top:14px; font-weight:900; color:#76f6ff88; }

  /* cards tray */
  .tray-area{ width:100%; margin-top:18px; display:flex; justify-content:center; }
  .cards{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; max-width:900px; }
  .card{
    background: var(--card); padding:12px 16px; border-radius:28px; cursor:grab; user-select:none;
    border:1px solid rgba(255,255,255,0.04); box-shadow:0 8px 30px rgba(0,0,0,0.5);
    font-size:20px; min-width:52px; text-align:center; transition:transform .14s ease, box-shadow .14s ease;
    color:#eafcff; font-weight:800;
  }
  .card:active{ cursor:grabbing; transform:scale(.98); }
  .card.ghost{ opacity:.4; transform:scale(.96); }
  .card.small{ padding:8px 10px; border-radius:20px; font-size:16px; min-width:40px; }

  /* placed */
  .placed{ background: rgba(255,255,255,0.03); border-radius:10px; padding:8px 10px; display:inline-block; margin:6px 6px 0 0; cursor:grab; font-weight:800; color:#e8ffff; }
  .placed.dragging{ opacity:.5; }

  /* success effect (mode D) */
  .poof{
    position:absolute; width:26px; height:26px; border-radius:100%; pointer-events:none;
    transform:scale(0); opacity:0; transition:all .36s ease;
  }

  /* glow animation */
  @keyframes glowPulse {
    0%{ box-shadow: 0 0 0 rgba(0,255,180,0); }
    40%{ box-shadow: 0 0 20px rgba(0,255,180,0.85), 0 0 36px rgba(0,255,180,0.35); }
    100%{ box-shadow: 0 0 0 rgba(0,255,180,0); }
  }

  /* wrong toss animation */
  .toss-anim{ animation: toss 520ms cubic-bezier(.2,.9,.2,1); }
  @keyframes toss{
    0%{ transform: translateY(0) rotate(0) scale(1); opacity:1 }
    40%{ transform: translateY(-28px) rotate(-15deg) scale(1.02); opacity:1 }
    100%{ transform: translateY(160px) rotate(30deg) scale(.6); opacity:0 }
  }

  /* shake */
  @keyframes shakeX{ 0%{transform:none}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-6px)}100%{transform:none} }
  .shake{ animation:shakeX .38s; }

  /* welcome modal */
  #welcome{
    position:fixed; inset:0; display:flex; justify-content:center; align-items:center; z-index:9998;
    background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.55));
  }
  .welcome-card{ background:linear-gradient(180deg,#071723,#04121a); padding:24px 28px; border-radius:14px; text-align:center; width:92%; max-width:760px; box-shadow:0 20px 60px rgba(0,0,0,0.7); color:#dffeff; border:1px solid rgba(255,255,255,0.04); }
  .welcome-key{ font-size:48px; margin-bottom:8px; transform:rotate(-8deg); display:inline-block; filter:drop-shadow(0 10px 30px rgba(0,240,255,0.08)); }
  .welcome-title{ font-weight:900; font-size:20px; margin-bottom:6px; letter-spacing:0.6px; }
  .welcome-text{ color:#bffbff; opacity:0.95; margin-bottom:14px; }
  .btn{ display:inline-block; padding:10px 16px; border-radius:12px; font-weight:800; cursor:pointer; border:none; margin:6px; }
  .btn.start{ background:linear-gradient(90deg,#00f0ff,#00d6a5); color:#032; box-shadow:0 8px 28px rgba(0,216,165,0.12); }
  .btn.later{ background:transparent; color:#9feef8; border:1px solid rgba(159,238,248,0.12); }

  /* small helpers */
  .muted{ color:#9beff6cc; font-size:13px; }
  .hint{ font-size:13px; color:#9feeea; opacity:.9; margin-top:8px; }
  footer{ margin-top:22px; color:#87f2ff88; font-size:13px; }
</style>
</head>
<body>
  <div id="welcome">
    <div class="welcome-card" role="dialog" aria-modal="true">
      <div class="welcome-key">ğŸ”</div>
      <div class="welcome-title">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ â€” Ù…Ø±Ø­Ù„Ù‡Ù” Û²</div>
      <div class="welcome-text">Ø¯Ø± Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ ÛŒÚ© Ø¹Ø¯Ø¯ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù‡Ù…â€ŒØ²Ù…Ø§Ù† Ø¹Ø¶Ùˆ Ú†Ù†Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¨Ø§Ø´Ø¯. Ú©Ø§Ø±Øª Ø±Ø§ Ø¨Ú©Ø´ Ùˆ Ø¯Ø± Ù‡Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ú©Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒØ§Ø´ ØµØ§Ø¯Ù‚ Ø§Ø³Øª Ø±Ù‡Ø§ Ú©Ù†. Ù‡ÛŒÚ† Ø®Ø·Ø§ÛŒ Ù…ØªÙ†ÛŒ Ø³Ø®ØªÛŒ Ø¯Ø§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ â€” ÙÙ‚Ø· Ø¨Ø§Ø²ÛŒ Ú©Ù† Ùˆ ÛŒØ§Ø¯ Ø¨Ú¯ÛŒØ±.</div>
      <div style="margin-bottom:8px;" class="muted">A = Ø§Ø¹Ø¯Ø§Ø¯ ÙØ±Ø¯  â€¢  B = Ø§Ø¹Ø¯Ø§Ø¯ Ú©ÙˆÚ†Ú©ØªØ± Ø§Ø² Û´  â€¢  C = Ø§Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ¬</div>
      <div>
        <button class="btn start" id="btnStart">Ø¨Ø§Ø² Ú©Ù† Ùˆ Ø´Ø±ÙˆØ¹ Ú©Ù†</button>
        <button class="btn later" id="btnLater">Ø¨Ø¹Ø¯Ø§Ù‹</button>
      </div>
    </div>
  </div>

  <h1>Ù…Ø±Ø­Ù„Ù‡ Û² â€” Ø§Ø´ØªØ±Ø§Ú© (Ø¢Ø²Ù…Ø§ÛŒØ´ ØªØ¹Ø§Ù…Ù„ÛŒ)</h1>
  <div class="subtitle">Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ú©Ø´ Ùˆ Ø¯Ø± Ù‡Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ú©Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒØ§Ø´ ØµØ§Ø¯Ù‚ Ø§Ø³Øª Ø±Ù‡Ø§ Ú©Ù† â€” Ø§Ú¯Ø± Ø¹Ø¯Ø¯ Ø¯Ùˆ ÙˆÛŒÚ˜Ú¯ÛŒ Ø¯Ø§Ø´ØªØŒ Ø¯Ø± Ù‡Ø± Ø¯Ùˆ Ø¨ÛŒÙ†Ø¯Ø§Ø².</div>

  <div class="top-row">
    <div id="scoreBox">ÙˆØ¶Ø¹ÛŒØª: <span id="statusText">Ø¢Ù…Ø§Ø¯Ù‡</span></div>
    <div id="introSmall">Ù‚ÙˆØ§Ù†ÛŒÙ†: A = Ø§Ø¹Ø¯Ø§Ø¯ ÙØ±Ø¯ â€” B = Ø§Ø¹Ø¯Ø§Ø¯ Ú©ÙˆÚ†Ú©ØªØ± Ø§Ø² Û´ â€” C = Ø§Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ¬. Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§: Û±ØŒÛ²ØŒÛ³ØŒÛ´ØŒÛµØŒÛ¶ØŒ (Ùˆ Ø¯Ùˆ Ú©Ø§Ø±Øª Ø§Ø¶Ø§ÙÛŒ: Û± Ùˆ Û²). Ù‡Ø± Ú©Ø§Ø±Øª Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¯Ø± Ú†Ù†Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù‚Ø±Ø§Ø± Ú¯ÛŒØ±Ø¯.</div>
  </div>

  <div class="board">
    <div class="set-box" data-set="A" id="setA">
      <div class="set-title">A = <span style="font-weight:900">{ }</span></div>
      <div class="set-rule">Ù‚Ø§Ù†ÙˆÙ†: Ø§Ø¹Ø¯Ø§Ø¯ ÙØ±Ø¯ (1, 3, 5)</div>
      <div class="set-contents" data-contents="A"></div>
      <div class="set-braces">A</div>
    </div>

    <div class="set-box" data-set="B" id="setB">
      <div class="set-title">B = <span style="font-weight:900">{ }</span></div>
      <div class="set-rule">Ù‚Ø§Ù†ÙˆÙ†: Ø§Ø¹Ø¯Ø§Ø¯ Ú©Ù…ØªØ± Ø§Ø² Û´ (1, 2, 3)</div>
      <div class="set-contents" data-contents="B"></div>
      <div class="set-braces">B</div>
    </div>

    <div class="set-box" data-set="C" id="setC">
      <div class="set-title">C = <span style="font-weight:900">{ }</span></div>
      <div class="set-rule">Ù‚Ø§Ù†ÙˆÙ†: Ø§Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ¬ (2, 4, 6)</div>
      <div class="set-contents" data-contents="C"></div>
      <div class="set-braces">C</div>
    </div>
  </div>

  <div class="tray-area">
    <div class="cards" id="tray">
      <!-- cards: include duplicates for 1 and 2 -->
      <div class="card" draggable="true" data-value="1">Û±</div>
      <div class="card" draggable="true" data-value="2">Û²</div>
      <div class="card" draggable="true" data-value="3">Û³</div>
      <div class="card" draggable="true" data-value="4">Û´</div>
      <div class="card" draggable="true" data-value="5">Ûµ</div>
      <div class="card" draggable="true" data-value="6">Û¶</div>
      <div class="card" draggable="true" data-value="1">Û±</div>
      <div class="card" draggable="true" data-value="2">Û²</div>
    </div>
  </div>

  <div id="message" style="margin-top:12px;"></div>
  <footer>ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ: Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ù‡Ù†Ú¯Ø§Ù… Ø±Ù‡Ø§ Ø´Ø¯Ù† Ø§Ø´ØªØ¨Ø§Ù‡ÛŒ Ú¯Ù… Ù†Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ â€” Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ù†Ø¯ Ø¨Ù‡ Ø³ÛŒÙ†ÛŒ Ø¨Ø§ ÛŒÚ© Ù¾Ø±ØªØ§Ø¨ Ú©ÙˆØªØ§Ù‡.</footer>

<script>
/* ---------- data ---------- */
const setsRules = {
  A: v => (v % 2 === 1),          // odd
  B: v => (v < 4),                // less than 4
  C: v => (v % 2 === 0)           // even
};

const setsExample = {
  A: [1,3,5],
  B: [1,2,3],
  C: [2,4,6]
};

const tray = document.getElementById('tray');
const boxes = document.querySelectorAll('.set-box');
const statusText = document.getElementById('statusText');
const welcome = document.getElementById('welcome');
const btnStart = document.getElementById('btnStart');
const btnLater = document.getElementById('btnLater');

function uniqueId(prefix='id'){ return prefix + '-' + Math.floor(Math.random()*1000000) + '-' + Date.now().toString(36); }

/* ---------- UX helpers ---------- */
function setStatus(text){
  statusText.textContent = text;
}

/* play poof effect in a set box (mode D) */
function poofAt(box){
  const p = document.createElement('div');
  p.className = 'poof';
  p.style.background = 'radial-gradient(circle at 30% 30%, rgba(0,255,200,0.95), rgba(0,200,120,0.75))';
  box.appendChild(p);
  // position center top-ish
  p.style.left = '50%'; p.style.top = '34%'; p.style.transform = 'translate(-50%,-50%) scale(0)';
  setTimeout(()=>{ p.style.transform = 'translate(-50%,-50%) scale(1)'; p.style.opacity = '1'; }, 30);
  setTimeout(()=>{ p.style.transform = 'translate(-50%,-50%) scale(1.6)'; p.style.opacity = '0'; }, 240);
  setTimeout(()=> p.remove(), 520);
}

/* highlight set briefly */
function flashSet(box){
  box.classList.add('highlight');
  setTimeout(()=> box.classList.remove('highlight'), 520);
}

/* create placed element in set */
function createPlacedElement(value, setName){
  const d = document.createElement('div');
  d.className = 'placed';
  d.textContent = value;
  d.dataset.value = value;
  d.dataset.set = setName;
  d.id = uniqueId('placed');
  makePlacedDraggable(d);
  return d;
}

/* ---------- drag & drop logic ---------- */

/* Make tray cards draggable (tray originals remain in tray â€” placing creates copies) */
function makeTrayCardDraggable(el){
  el.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', el.dataset.value);
    e.dataTransfer.setData('origin', 'tray');
    e.dataTransfer.setData('dragId', el.id || uniqueId('tray'));
    // small visual hint
    el.classList.add('ghost');
    setStatus('Ø¯Ø± Ø­Ø§Ù„ Ú©Ø´ÛŒØ¯Ù† Ú©Ø§Ø±Øª...');
  });
  el.addEventListener('dragend', e=>{
    el.classList.remove('ghost');
    setStatus('Ø¢Ù…Ø§Ø¯Ù‡');
  });
}

/* Make placed copies draggable & removable */
function makePlacedDraggable(el){
  // enable dragging the placed copy to move between sets or delete (drop on tray)
  el.setAttribute('draggable', 'true');
  el.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', el.dataset.value);
    e.dataTransfer.setData('origin', 'placed');
    e.dataTransfer.setData('dragId', el.id);
    e.dataTransfer.setData('fromSet', el.dataset.set || '');
    el.classList.add('dragging');
    setStatus('Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ú©Ø§Ø±Øª Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡...');
  });
  el.addEventListener('dragend', e=>{
    el.classList.remove('dragging');
    setStatus('Ø¢Ù…Ø§Ø¯Ù‡');
  });

  // click to remove the placed copy (user can take it back)
  el.addEventListener('click', ()=>{
    // gentle remove animation
    el.style.transition = 'transform .32s ease, opacity .28s ease';
    el.style.transform = 'translateY(8px) scale(.9)';
    el.style.opacity = '0';
    setTimeout(()=> el.remove(), 300);
  });
}

/* set drop handlers */
boxes.forEach(box=>{
  box.addEventListener('dragover', e=> e.preventDefault());
  box.addEventListener('dragenter', e=>{ box.classList.add('highlight'); });
  box.addEventListener('dragleave', e=>{ box.classList.remove('highlight'); });

  box.addEventListener('drop', e=>{
    e.preventDefault();
    box.classList.remove('highlight');
    const value = Number(e.dataTransfer.getData('value'));
    const origin = e.dataTransfer.getData('origin'); // tray or placed
    const dragId = e.dataTransfer.getData('dragId');
    const fromSet = e.dataTransfer.getData('fromSet');

    handleDropToSet({value, origin, dragId, fromSet}, box);
  });
});

/* tray drop area: used to delete placed copies if dropped on tray */
tray.addEventListener('dragover', e=> e.preventDefault());
tray.addEventListener('drop', e=>{
  e.preventDefault();
  const origin = e.dataTransfer.getData('origin');
  const dragId = e.dataTransfer.getData('dragId');

  if(origin === 'placed'){
    const placedEl = document.getElementById(dragId);
    if(placedEl){
      // remove the placed copy (user returned it to tray)
      placedEl.remove();
      setStatus('Ú©Ø§Ø±Øª Ø¨Ø±Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯.');
    }
  }
});

/* handle drop logic */
function handleDropToSet(drag, box){
  const setName = box.dataset.set;
  const contentsEl = box.querySelector('.set-contents');
  const value = Number(drag.value);

  // check duplicate in same set
  const existingVals = Array.from(contentsEl.children).map(n => Number(n.dataset.value));
  if(existingVals.includes(value)){
    // small shake and a toss-back effect (no textual error)
    box.classList.add('shake');
    setTimeout(()=> box.classList.remove('shake'), 380);
    // make a quick toss visual
    animateInvalidPlace(box);
    setStatus('Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø± Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡.');
    return;
  }

  // membership check
  const rule = setsRules[setName];
  const ok = rule(value);
  if(!ok){
    // wrong placement: animate toss and return
    animateInvalidPlace(box);
    setStatus('Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø¹Ø¯Ø¯ Ù…Ù†Ø§Ø³Ø¨ Ù†ÛŒØ³Øª â€” Ú©Ø§Ø±Øª Ø¨Ù‡ Ø³ÛŒÙ†ÛŒ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.');
    return;
  }

  // allowed placement
  if(drag.origin === 'tray'){
    // create placed copy inside set (tray original remains)
    const placed = createPlacedElement(value, setName);
    // add entry
    contentsEl.appendChild(placed);
    // mode D effects
    flashSet(box);
    poofAt(box);
    placed.style.transform = 'rotate(-18deg) scale(.98)';
    placed.style.opacity = '0';
    setTimeout(()=>{ placed.style.transition = 'transform .36s cubic-bezier(.2,.9,.2,1), opacity .28s ease'; placed.style.transform = 'none'; placed.style.opacity = '1'; }, 10);
    // small glow
    placed.style.boxShadow = '0 8px 28px rgba(0,255,180,0.08)';
    setTimeout(()=> placed.style.boxShadow = '', 720);

    setStatus(`Ø¹Ø¯Ø¯ ${value} Ø¯Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØª.`);
    return;
  }

  if(drag.origin === 'placed'){
    // moving a placed copy between sets: move original element (dragId)
    const orig = document.getElementById(drag.dragId);
    if(!orig){ setStatus('Ù‡ÛŒÚ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø¬Ø§Ø¨Ø¬Ø§ Ú©Ø±Ø¯Ù† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯'); return; }
    const origFrom = drag.fromSet || orig.dataset.set;
    // if same set -> restore
    if(origFrom === setName){
      // nothing to do (just restore visuals)
      orig.style.visibility = 'visible';
      setStatus('Ø¯Ø± Ù‡Ù…Ø§Ù† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø±Ù‡Ø§ Ø´Ø¯.');
      return;
    }
    // final move: remove from old parent and append to new
    orig.remove();
    orig.dataset.set = setName;
    const moved = orig; // reuse element
    moved.classList.remove('dragging');
    // animation
    moved.style.opacity = '0';
    contentsEl.appendChild(moved);
    setTimeout(()=> moved.style.opacity = '1', 20);
    flashSet(box);
    poofAt(box);
    setStatus(`Ú©Ø§Ø±Øª Ø§Ø² ${origFrom} Ø¨Ù‡ ${setName} Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯.`);
    return;
  }
}

/* animate invalid placement: quick toss from box to tray visual */
function animateInvalidPlace(box){
  // create a temp ball near the box and toss it downwards to tray
  const tmp = document.createElement('div');
  tmp.className = 'card toss-anim';
  tmp.textContent = 'âœ–';
  tmp.style.position = 'absolute';
  tmp.style.left = '50%';
  tmp.style.top = '60%';
  tmp.style.transform = 'translate(-50%,-50%)';
  tmp.style.zIndex = 999;
  tmp.style.pointerEvents = 'none';
  tmp.style.background = 'linear-gradient(180deg, rgba(255,80,80,0.13), rgba(255,80,80,0.06))';
  tmp.style.border = '1px solid rgba(255,90,90,0.12)';
  tmp.style.color = '#fff';
  tmp.style.padding = '8px 10px';
  tmp.style.borderRadius = '12px';
  box.appendChild(tmp);
  // remove after animation
  setTimeout(()=> tmp.remove(), 520);
}

/* make initial tray draggables */
document.querySelectorAll('#tray .card').forEach(el=>{
  // give each tray card an id if missing
  if(!el.id) el.id = uniqueId('tray');
  makeTrayCardDraggable(el);
});

/* small keyboard support: Esc to close welcome */
document.addEventListener('keydown', e=>{
  if(e.key === 'Escape'){
    if(welcome.style.display !== 'none') hideWelcome();
  }
});

/* welcome controls */
btnStart.addEventListener('click', ()=> hideWelcome());
btnLater.addEventListener('click', ()=> hideWelcome());

function hideWelcome(){
  if(!welcome) return;
  welcome.style.display = 'none';
  setStatus('Ø¢Ù…Ø§Ø¯Ù‡ â€” Ø¨Ø§Ø²ÛŒ Ú©Ù†!');
}

/* init status */
setStatus('Ø¢Ù…Ø§Ø¯Ù‡');

/* optional: update set-title braces to show current contents (reactive) */
const updateSetBraces = () => {
  document.querySelectorAll('.set-box').forEach(box=>{
    const name = box.dataset.set;
    const list = Array.from(box.querySelectorAll('.set-contents .placed')).map(n=>n.dataset.value);
    const bracesEl = box.querySelector('.set-title span');
    bracesEl.textContent = '{ ' + list.join(' , ') + ' }';
  });
};
// observe mutations to set-contents to update braces when placed elements change
const obsConfig = { childList:true, subtree:true };
document.querySelectorAll('.set-contents').forEach(node=>{
  const mo = new MutationObserver(()=> updateSetBraces());
  mo.observe(node, obsConfig);
});
updateSetBraces();

</script>
</body>
</html>

