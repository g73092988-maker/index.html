<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ø±Ø­Ù„Ù‡ Û² â€” Ø¢Ø²Ù…Ø§ÛŒØ´ ØªØ¹Ø§Ù…Ù„ÛŒ</title>
<style>
  :root{
    --bg1:#061229; /* deep navy */
    --bg2:#07182a;
    --panel:#0d2130;
    --card:#0f2a36;
    --accent:#8be0ff;   /* cyan-ish */
    --accent-2:#ffd36b; /* warm highlight */
    --good:#5fe08b;
    --bad:#ff7b7b;
    --glass: rgba(255,255,255,0.03);
    --math-blue:#6fb3ff;
    --math-purple:#9b8cff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; padding:26px; font-family: Vazirmatn, "Segoe UI", Roboto, "Helvetica Neue", Arial, system-ui;
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    color:#e6f7fb; text-align:center; min-height:100vh;
  }
  h1{ margin:6px 0 8px; font-size:22px; letter-spacing:0.6px; color:var(--math-blue); }
  .subtitle{ color:#bfeeff66; margin-bottom:12px; font-size:14px; }

  /* header row: small status */
  .top-row{ display:flex; gap:14px; justify-content:center; align-items:center; flex-wrap:wrap; margin-bottom:12px; }
  #statusBox{ background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04)); padding:8px 12px; border-radius:10px; font-weight:800; color:var(--accent); border:1px solid rgba(139,224,255,0.06); }

  /* board layout */
  .board{ display:flex; gap:18px; justify-content:center; align-items:flex-start; flex-wrap:wrap; margin-top:6px; padding:8px; }

  .set-box{
    width:300px; min-height:150px; padding:14px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.06));
    border:1px solid rgba(255,255,255,0.035); position:relative; box-shadow:0 10px 30px rgba(3,10,20,0.6);
    transition:transform .22s cubic-bezier(.2,.9,.2,1), box-shadow .22s ease;
  }
  .set-box.highlight{ transform:translateY(-6px) scale(1.01); box-shadow:0 20px 48px rgba(43,120,200,0.06); }
  .set-title{ font-weight:900; font-size:18px; margin-bottom:6px; color:var(--math-purple); display:flex; justify-content:space-between; align-items:center; }
  .set-rule{ font-size:13px; color:#bfeaff; opacity:0.95; margin-bottom:8px; }
  .set-contents{ min-height:76px; display:flex; gap:8px; flex-wrap:wrap; align-items:flex-start; padding:6px; border-radius:8px; background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(255,255,255,0.01)); }

  .set-braces{ font-weight:900; color:var(--accent-2); font-size:13px; background:linear-gradient(90deg, rgba(255,211,120,0.06), rgba(139,224,255,0.02)); padding:4px 8px; border-radius:8px; }

  /* tray and cards */
  .tray-area{ width:100%; margin-top:16px; display:flex; justify-content:center; }
  .cards{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; max-width:980px; }
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(0,0,0,0.06)); padding:12px 16px; border-radius:28px; cursor:grab; user-select:none;
    border:1px solid rgba(255,255,255,0.03); box-shadow:0 8px 22px rgba(0,0,0,0.5);
    font-size:20px; min-width:54px; text-align:center; transition:transform .12s ease, box-shadow .12s ease;
    color:#e9fbff; font-weight:900;
  }
  .card:active{ cursor:grabbing; transform:scale(.98); }
  .card.ghost{ opacity:.45; transform:scale(.96); }

  /* placed */
  .placed{ background: rgba(255,255,255,0.02); border-radius:10px; padding:8px 10px; display:inline-block; margin:6px 6px 0 0; cursor:grab; font-weight:800; color:#efffff; border:1px solid rgba(139,224,255,0.04); }
  .placed.dragging{ opacity:.5; }

  /* poof effect */
  .poof{ position:absolute; width:26px; height:26px; border-radius:100%; pointer-events:none; transform:scale(0); opacity:0; transition:all .36s ease; }

  /* toss animation (wrong) */
  .toss-anim{ animation: toss 520ms cubic-bezier(.2,.9,.2,1); }
  @keyframes toss{
    0%{ transform: translateY(0) rotate(0) scale(1); opacity:1 }
    40%{ transform: translateY(-26px) rotate(-12deg) scale(1.02); opacity:1 }
    100%{ transform: translateY(160px) rotate(24deg) scale(.6); opacity:0 }
  }

  @keyframes shakeX{ 0%{transform:none}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-6px)}100%{transform:none} }
  .shake{ animation:shakeX .36s; }

  /* welcome modal (kept, slightly restyled) */
  #welcome{
    position:fixed; inset:0; display:flex; justify-content:center; align-items:center; z-index:9998;
    background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.55));
  }
  .welcome-card{ background:linear-gradient(180deg,#07142a,#041022); padding:22px 26px; border-radius:12px; text-align:center; width:92%; max-width:640px; box-shadow:0 20px 60px rgba(0,0,0,0.7); color:#e7fbff; border:1px solid rgba(255,255,255,0.04); }
  .welcome-key{ font-size:44px; margin-bottom:8px; transform:rotate(-6deg); display:inline-block; }
  .welcome-title{ font-weight:900; font-size:20px; margin-bottom:6px; color:var(--math-blue); }
  .welcome-text{ color:#cfeeff; opacity:0.96; margin-bottom:12px; font-size:14px; line-height:1.4; }
  .btn{ display:inline-block; padding:10px 16px; border-radius:12px; font-weight:800; cursor:pointer; border:none; margin:6px; }
  .btn.start{ background:linear-gradient(90deg,var(--math-blue),var(--math-purple)); color:#042032; box-shadow:0 10px 30px rgba(111,179,255,0.08); }
  .btn.later{ background:transparent; color:#9feef8; border:1px solid rgba(159,238,248,0.10); }

  /* helper text */
  .muted{ color:#9beff6cc; font-size:13px; }
  footer{ display:none } /* removed footer as requested */
</style>
</head>
<body>
  <div id="welcome" aria-hidden="false">
    <div class="welcome-card" role="dialog" aria-modal="true">
      <div class="welcome-key">ğŸ—ï¸</div>
      <div class="welcome-title">Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡Ù” Ø¯ÙˆÙ… Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ</div>
      <div class="welcome-text">Ø¯Ø± Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ù…Ù…Ú©Ù† Ø§Ø³Øª ÛŒÚ© Ú©Ø§Ø±Øª Ø±Ø§ Ú†Ù†Ø¯ Ø¨Ø§Ø± Ø¨Ø¨ÛŒÙ†ÛŒ â€” ÛŒØ¹Ù†ÛŒ ÛŒÚ© Ø¹Ø¯Ø¯ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ù‡ Ú†Ù†Ø¯ Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ù…Ø¹ØªØ¨Ø± ØªØ¹Ù„Ù‚ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯. Ú©Ø§Ø±Øª Ø±Ø§ Ø¨Ú©Ø´ Ùˆ Ø¯Ø± Ù‡Ø±Ø®Ø§Ù†Ù‡â€ŒØ§ÛŒ Ú©Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒØ§Ø´ Ø¨Ø±Ù‚Ø±Ø§Ø± Ø§Ø³Øª Ø±Ù‡Ø§ Ú©Ù†. Ø¨Ø§Ø²ÛŒ ØªØ¬Ø±Ø¨Ù‡â€ŒÙ…Ø­ÙˆØ± Ø§Ø³ØªØ› Ù†Ú¯Ø±Ø§Ù† Ù¾ÛŒØºØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§ÛŒ Ø³Ø®Øª Ù†Ø¨Ø§Ø´.</div>
      <div style="margin-bottom:6px;" class="muted">Ù‚ÙˆØ§Ø¹Ø¯ Ù‡Ø± Ø¨Ø§Ú©Ø³ Ø¯Ø± Ù‡Ù…Ø§Ù† Ø¨Ø§Ú©Ø³ Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ â€” Ø§Ø² Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡ Ø¨Ø±Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯ ØªØ§ ØµÙØ­Ù‡ ØªÙ…ÛŒØ²ØªØ± Ùˆ ØªÙ…Ø±Ú©Ø²ÛŒâ€ŒØªØ± Ø¨Ø§Ø´Ø¯.</div>
      <div>
        <button class="btn start" id="btnStart">Ø´Ø±ÙˆØ¹ Ú©Ù†</button>
        <button class="btn later" id="btnLater">Ø¨Ø¹Ø¯Ø§Ù‹</button>
      </div>
    </div>
  </div>

  <h1>Ù…Ø±Ø­Ù„Ù‡ Û² â€” Ø¢Ø²Ù…Ø§ÛŒØ´ ØªØ¹Ø§Ù…Ù„ÛŒ</h1>
  <div class="subtitle">Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ú©Ø´ Ùˆ Ø¯Ø± Ù‡Ø± Ø¨Ø§Ú©Ø³ Ú©Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒÙ Ø¹Ø¯Ø¯ Ø¨Ø±Ù‚Ø±Ø§Ø± Ø§Ø³Øª Ø±Ù‡Ø§ Ú©Ù† â€” Ø§Ú¯Ø± Ø¹Ø¯Ø¯ Ú†Ù†Ø¯ ÙˆÛŒÚ˜Ú¯ÛŒ Ø¯Ø§Ø´ØªØŒ Ø¯Ø± Ù‡Ø± Ú©Ø¯Ø§Ù… Ø¨ÛŒÙ†Ø¯Ø§Ø².</div>

  <div class="top-row">
    <div id="statusBox">ÙˆØ¶Ø¹ÛŒØª: <span id="statusText">Ø¢Ù…Ø§Ø¯Ù‡</span></div>
  </div>

  <div class="board" aria-live="polite">
    <div class="set-box" data-set="A" id="setA">
      <div class="set-title">
        A
        <span class="set-braces">{ }</span>
      </div>
      <div class="set-rule">Ù‚Ø§Ù†ÙˆÙ†: Ø§Ø¹Ø¯Ø§Ø¯ ÙØ±Ø¯ â€” Ù…Ø«Ø§Ù„: 1 , 3 , 5</div>
      <div class="set-contents" data-contents="A" aria-label="Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” A"></div>
    </div>

    <div class="set-box" data-set="B" id="setB">
      <div class="set-title">
        B
        <span class="set-braces">{ }</span>
      </div>
      <div class="set-rule">Ù‚Ø§Ù†ÙˆÙ†: Ø§Ø¹Ø¯Ø§Ø¯ Ú©Ù…ØªØ± Ø§Ø² Û´ â€” Ù…Ø«Ø§Ù„: 1 , 2 , 3</div>
      <div class="set-contents" data-contents="B" aria-label="Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” B"></div>
    </div>

    <div class="set-box" data-set="C" id="setC">
      <div class="set-title">
        C
        <span class="set-braces">{ }</span>
      </div>
      <div class="set-rule">Ù‚Ø§Ù†ÙˆÙ†: Ø§Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ¬ â€” Ù…Ø«Ø§Ù„: 2 , 4 , 6</div>
      <div class="set-contents" data-contents="C" aria-label="Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” C"></div>
    </div>
  </div>

  <div class="tray-area" aria-label="Ø³ÛŒÙ†ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§">
    <div class="cards" id="tray">
      <!-- cards (Ø´Ø§Ù…Ù„ Ø¯Ùˆ Ú©Ø§Ø±Øª Ø§Ø¶Ø§ÙÛŒ 1 Ùˆ 2) -->
      <div class="card" draggable="true" data-value="1">Û±</div>
      <div class="card" draggable="true" data-value="2">Û²</div>
      <div class="card" draggable="true" data-value="3">Û³</div>
      <div class="card" draggable="true" data-value="4">Û´</div>
      <div class="card" draggable="true" data-value="5">Ûµ</div>
      <div class="card" draggable="true" data-value="6">Û¶</div>
      <div class="card" draggable="true" data-value="1">Û±</div>
      <div class="card" draggable="true" data-value="2">Û²</div>
    </div>
  </div>

<script>
/* ---------- Ù‚ÙˆØ§Ø¹Ø¯ Ùˆ Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ (Ø­Ø§Ù„Øª D Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯) ---------- */
const setsRules = {
  A: v => (v % 2 === 1),          // odd
  B: v => (v < 4),                // less than 4
  C: v => (v % 2 === 0)           // even
};

const tray = document.getElementById('tray');
const boxes = document.querySelectorAll('.set-box');
const statusText = document.getElementById('statusText');
const welcome = document.getElementById('welcome');
const btnStart = document.getElementById('btnStart');
const btnLater = document.getElementById('btnLater');

function uniqueId(prefix='id'){ return prefix + '-' + Math.floor(Math.random()*1000000) + '-' + Date.now().toString(36); }

function setStatus(text){ statusText.textContent = text; }

/* visual helpers */
function poofAt(box){
  const p = document.createElement('div');
  p.className = 'poof';
  p.style.background = 'radial-gradient(circle at 30% 30%, rgba(139,224,255,0.95), rgba(107,179,255,0.6))';
  box.appendChild(p);
  p.style.left = '50%'; p.style.top = '34%'; p.style.transform = 'translate(-50%,-50%) scale(0)';
  setTimeout(()=>{ p.style.transform = 'translate(-50%,-50%) scale(1)'; p.style.opacity = '1'; }, 30);
  setTimeout(()=>{ p.style.transform = 'translate(-50%,-50%) scale(1.6)'; p.style.opacity = '0'; }, 240);
  setTimeout(()=> p.remove(), 520);
}
function flashSet(box){
  box.classList.add('highlight');
  setTimeout(()=> box.classList.remove('highlight'), 520);
}
function createPlacedElement(value, setName){
  const d = document.createElement('div');
  d.className = 'placed';
  d.textContent = value;
  d.dataset.value = value;
  d.dataset.set = setName;
  d.id = uniqueId('placed');
  makePlacedDraggable(d);
  return d;
}

/* ---------- drag & drop ---------- */
function makeTrayCardDraggable(el){
  if(!el.id) el.id = uniqueId('tray');
  el.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', el.dataset.value);
    e.dataTransfer.setData('origin', 'tray');
    e.dataTransfer.setData('dragId', el.id);
    el.classList.add('ghost');
    setStatus('Ø¯Ø± Ø­Ø§Ù„ Ú©Ø´ÛŒØ¯Ù† Ú©Ø§Ø±Øª...');
  });
  el.addEventListener('dragend', e=>{
    el.classList.remove('ghost');
    setStatus('Ø¢Ù…Ø§Ø¯Ù‡');
  });
}
function makePlacedDraggable(el){
  el.setAttribute('draggable', 'true');
  el.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', el.dataset.value);
    e.dataTransfer.setData('origin', 'placed');
    e.dataTransfer.setData('dragId', el.id);
    e.dataTransfer.setData('fromSet', el.dataset.set || '');
    el.classList.add('dragging');
    setStatus('Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ú©Ø§Ø±Øª Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡...');
  });
  el.addEventListener('dragend', e=>{
    el.classList.remove('dragging');
    setStatus('Ø¢Ù…Ø§Ø¯Ù‡');
  });
  el.addEventListener('click', ()=>{
    el.style.transition = 'transform .28s ease, opacity .22s ease';
    el.style.transform = 'translateY(8px) scale(.9)';
    el.style.opacity = '0';
    setTimeout(()=> el.remove(), 260);
  });
}

/* set handlers */
boxes.forEach(box=>{
  box.addEventListener('dragover', e=> e.preventDefault());
  box.addEventListener('dragenter', e=> box.classList.add('highlight'));
  box.addEventListener('dragleave', e=> box.classList.remove('highlight'));
  box.addEventListener('drop', e=>{
    e.preventDefault();
    box.classList.remove('highlight');
    const value = Number(e.dataTransfer.getData('value'));
    const origin = e.dataTransfer.getData('origin');
    const dragId = e.dataTransfer.getData('dragId');
    const fromSet = e.dataTransfer.getData('fromSet');
    handleDropToSet({value, origin, dragId, fromSet}, box);
  });
});

/* tray drop => remove placed copy (return to tray) */
tray.addEventListener('dragover', e=> e.preventDefault());
tray.addEventListener('drop', e=>{
  e.preventDefault();
  const origin = e.dataTransfer.getData('origin');
  const dragId = e.dataTransfer.getData('dragId');
  if(origin === 'placed'){
    const placedEl = document.getElementById(dragId);
    if(placedEl) placedEl.remove();
    setStatus('Ú©Ø§Ø±Øª Ø¨Ø±Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯.');
  }
});

/* invalid place animation */
function animateInvalidPlace(box){
  const tmp = document.createElement('div');
  tmp.className = 'card toss-anim';
  tmp.textContent = 'âœ–';
  tmp.style.position = 'absolute';
  tmp.style.left = '50%';
  tmp.style.top = '60%';
  tmp.style.transform = 'translate(-50%,-50%)';
  tmp.style.zIndex = 999;
  tmp.style.pointerEvents = 'none';
  tmp.style.background = 'linear-gradient(180deg, rgba(255,120,120,0.08), rgba(255,80,80,0.04))';
  tmp.style.border = '1px solid rgba(255,120,120,0.08)';
  tmp.style.color = '#fff';
  tmp.style.padding = '8px 10px';
  tmp.style.borderRadius = '12px';
  box.appendChild(tmp);
  setTimeout(()=> tmp.remove(), 520);
}

/* main drop logic */
function handleDropToSet(drag, box){
  const setName = box.dataset.set;
  const contentsEl = box.querySelector('.set-contents');
  const value = Number(drag.value);
  const existingVals = Array.from(contentsEl.children).map(n => Number(n.dataset.value));
  if(existingVals.includes(value)){
    box.classList.add('shake');
    setTimeout(()=> box.classList.remove('shake'), 360);
    animateInvalidPlace(box);
    setStatus('Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø± Ø§ÛŒÙ† Ø®Ø§Ù†Ù‡ Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡.');
    return;
  }
  const rule = setsRules[setName];
  const ok = rule(value);
  if(!ok){
    animateInvalidPlace(box);
    setStatus('Ø§ÛŒÙ† Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø¹Ø¯Ø¯ Ù…Ù†Ø§Ø³Ø¨ Ù†ÛŒØ³Øª â€” Ú©Ø§Ø±Øª Ø¨Ù‡ Ø³ÛŒÙ†ÛŒ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.');
    return;
  }
  if(drag.origin === 'tray'){
    const placed = createPlacedElement(value, setName);
    contentsEl.appendChild(placed);
    flashSet(box);
    poofAt(box);
    placed.style.transform = 'rotate(-12deg) scale(.98)';
    placed.style.opacity = '0';
    setTimeout(()=>{ placed.style.transition = 'transform .36s cubic-bezier(.2,.9,.2,1), opacity .28s ease'; placed.style.transform = 'none'; placed.style.opacity = '1'; }, 10);
    setStatus(`Ø¹Ø¯Ø¯ ${value} Ø¯Ø± ${setName} Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØª.`);
    return;
  }
  if(drag.origin === 'placed'){
    const orig = document.getElementById(drag.dragId);
    if(!orig){ setStatus('Ù‡ÛŒÚ†â€ŒÚ†ÛŒØ² Ø¨Ø±Ø§ÛŒ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ù†ÛŒØ³Øª'); return; }
    const origFrom = drag.fromSet || orig.dataset.set;
    if(origFrom === setName){
      orig.style.visibility = 'visible';
      setStatus('Ø¯Ø± Ù‡Ù…Ø§Ù† Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø±Ù‡Ø§ Ø´Ø¯.');
      return;
    }
    orig.remove();
    orig.dataset.set = setName;
    contentsEl.appendChild(orig);
    flashSet(box);
    poofAt(box);
    setStatus(`Ú©Ø§Ø±Øª Ø§Ø² ${origFrom} Ø¨Ù‡ ${setName} Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯.`);
    return;
  }
}

/* init draggables */
document.querySelectorAll('#tray .card').forEach(el => makeTrayCardDraggable(el));

/* update braces { ... } reactive */
const updateSetBraces = () => {
  document.querySelectorAll('.set-box').forEach(box=>{
    const list = Array.from(box.querySelectorAll('.set-contents .placed')).map(n=>n.dataset.value);
    const bracesEl = box.querySelector('.set-braces');
    bracesEl.textContent = '{ ' + list.join(' , ') + ' }';
  });
};
const obsConfig = { childList:true, subtree:true };
document.querySelectorAll('.set-contents').forEach(node=>{
  const mo = new MutationObserver(()=> updateSetBraces());
  mo.observe(node, obsConfig);
});
updateSetBraces();

/* welcome controls */
btnStart.addEventListener('click', ()=> hideWelcome());
btnLater.addEventListener('click', ()=> hideWelcome());
function hideWelcome(){ if(!welcome) return; welcome.style.display = 'none'; setStatus('Ø¢Ù…Ø§Ø¯Ù‡ â€” Ø¨Ø§Ø²ÛŒ Ú©Ù†!'); }
document.addEventListener('keydown', e=>{ if(e.key === 'Escape'){ hideWelcome(); } });

/* initial status */
setStatus('Ø¢Ù…Ø§Ø¯Ù‡');

</script>
</body>
</html>
