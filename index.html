<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ø±Ø­Ù„Ù‡ Û² â€” Ø§Ø´ØªØ±Ø§Ú© (Ù…Ù‚Ø¯Ù…Ø§ØªÛŒ)</title>
<style>
  :root{
    --bg:#071126;
    --panel:#0f1724;
    --glass: rgba(255,255,255,0.04);
    --accent:#6ee7b7;
    --accent2:#7dd3fc;
    --muted:#9fb4c8;
    --good:#22c55e;
    --bad:#ff6b6b;
    --gold:#f6d365;
  }
  *{box-sizing:border-box}
  body{
    margin:0; padding:28px; font-family: Vazirmatn, system-ui, system-ui,-apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(34,50,82,0.65), transparent),
                linear-gradient(180deg,#041021 0%, #071126 100%);
    color:#e6f0fb; text-align:center; min-height:100vh;
  }
  h1{ margin:6px 0 16px; font-size:22px; color:var(--accent2); letter-spacing:0.6px; }
  /* top info row */
  .top-row{ display:flex; gap:12px; justify-content:center; align-items:center; margin-bottom:18px; flex-wrap:wrap; }
  .badge{
    background: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.04);
    padding:10px 14px; border-radius:12px; font-weight:700; color:var(--muted); min-width:140px;
  }

  /* sets area */
  .sets-wrap{ display:flex; gap:18px; justify-content:center; align-items:flex-start; flex-wrap:wrap; margin-bottom:20px; }
  .set-box{
    width:260px; background:var(--panel); border-radius:14px; padding:14px; position:relative;
    border:2px solid rgba(125,211,252,0.06); box-shadow: 0 8px 30px rgba(2,6,23,0.6);
  }
  .set-header{ display:flex; justify-content:space-between; align-items:center; font-weight:800; color:var(--accent2); margin-bottom:8px; font-size:16px; }
  .set-title{ font-family: "Courier New", monospace; font-size:15px; color:#dff8ff; }
  .set-desc{ font-size:13px; color:var(--muted); text-align:left; margin-top:6px; line-height:1.25; }

  /* brace display */
  .brace{ font-family: "Courier New", monospace; font-size:15px; color:#aee; margin-top:8px; text-align:left; min-height:36px; }

  /* placed chips */
  .set-contents{ margin-top:10px; display:flex; gap:8px; flex-wrap:wrap; align-items:center; justify-content:flex-start; min-height:36px; }
  .chip{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:6px 10px; border-radius:10px; font-weight:700; cursor:pointer; user-select:none;
    border:1px solid rgba(125,211,252,0.06);
  }
  .chip:hover{ transform:translateY(-4px); transition:transform .18s; }

  /* tray */
  .tray{ margin:18px auto 10px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; max-width:920px; }
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:28px; padding:12px 18px; min-width:56px; text-align:center; font-size:18px;
    cursor:grab; user-select:none; border:1px solid rgba(255,255,255,0.04); box-shadow: 0 8px 20px rgba(2,6,23,0.5);
  }
  .card:active{ cursor:grabbing; transform:scale(.99); }
  .card.fade{ opacity:.28; transform:scale(.98); }

  /* small tips */
  .hint{ color:var(--muted); margin-top:10px; font-size:14px; }

  /* entrance overlay (curtain + key) */
  #overlay{
    position:fixed; inset:0; display:flex; justify-content:center; align-items:center; z-index:9999;
    background: linear-gradient(180deg, rgba(2,6,23,0.85), rgba(2,6,23,0.9));
    backdrop-filter: blur(3px);
  }
  .curtain{
    position:absolute; inset:0; background: linear-gradient(180deg, rgba(20,60,30,0.9), rgba(10,30,20,0.95));
    display:flex; justify-content:center; align-items:center; flex-direction:column;
    animation: curtainIn .9s ease both;
  }
  @keyframes curtainIn{ from{opacity:0; transform:scale(1.06)} to{opacity:1; transform:none} }

  .curtain .title{ font-size:22px; font-weight:900; color:var(--accent); margin-bottom:10px; text-shadow:0 6px 30px rgba(0,200,170,0.06); }
  .curtain .sub{ color:var(--muted); font-size:15px; max-width:560px; text-align:center; margin-bottom:18px; }

  .keyWrap{ opacity:0; transform:translateY(16px) scale(.98); transition:all .6s cubic-bezier(.2,.9,.2,1) .6s; }
  .keyWrap.show{ opacity:1; transform:none; }

  .key{
    background: linear-gradient(90deg,#ffd86b,#f6d365);
    color:#072222; font-weight:900; padding:14px 22px; border-radius:999px; cursor:pointer;
    box-shadow: 0 12px 40px rgba(246,211,101,0.15), inset 0 -6px 16px rgba(0,0,0,0.06);
    border:0; font-size:16px;
  }
  .key:active{ transform:translateY(2px); }

  /* subtle pulse when placed */
  .flashPulse{ animation: pulseGreen .8s ease; }
  @keyframes pulseGreen{ 0%{box-shadow:0 0 0 rgba(34,197,94,0)} 40%{box-shadow:0 0 26px rgba(34,197,94,0.18)} 100%{box-shadow:0 0 0 rgba(34,197,94,0)} }

  /* shake */
  @keyframes shake{0%{transform:none}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-6px)}100%{transform:none}}
  .shake{ animation:shake .36s; }

  /* small responsive */
  @media (max-width:860px){
    .set-box{ width:92%; max-width:420px; }
  }
</style>
</head>
<body>

  <h1>Ù…Ø±Ø­Ù„Ù‡Ù” Û² â€” Ø¢Ø²Ù…Ø§ÛŒØ´Ù Â«Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù‡Ù…â€ŒØ²Ù…Ø§Ù† Ø¯Ø± Ú†Ù†Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¨Ø§Ø´Ø¯Â»</h1>

  <div class="top-row" aria-hidden="true">
    <div class="badge">Ù‡Ø¯Ù: ØªØ´Ø®ÛŒØµ Ø¹Ø¶ÙˆÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡Ù…â€ŒØ²Ù…Ø§Ù†</div>
    <div class="badge">Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§: Û± ØŒ Û² ØŒ Û³ ØŒ Û´ ØŒ Ûµ ØŒ Û¶ ØŒ Û± ØŒ Û²</div>
    <div class="badge">Ø±ÙˆØ´: Ú©Ø§Ø±Øª Ø±Ø§ Ø¨Ú©Ø´ Ùˆ Ø¯Ø± Ù‡Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ú©Ù‡ Ø´Ø±Ø· Ø±Ø§ Ø¯Ø§Ø±Ø¯ Ø±Ù‡Ø§ Ú©Ù†</div>
  </div>

  <div class="sets-wrap">
    <div class="set-box" data-set="A" id="boxA">
      <div class="set-header">
        <div class="set-title">A = { }</div>
        <div style="font-size:12px;color:var(--muted)">A</div>
      </div>
      <div class="set-desc">Ù‚ÙˆØ§Ù†ÛŒÙ†: Ø§Ø¹Ø¶Ø§ÛŒ ÙØ±Ø¯</div>
      <div class="brace" id="braceA">A = { }</div>
      <div class="set-contents" id="contentsA"></div>
    </div>

    <div class="set-box" data-set="B" id="boxB">
      <div class="set-header">
        <div class="set-title">B = { }</div>
        <div style="font-size:12px;color:var(--muted)">B</div>
      </div>
      <div class="set-desc">Ù‚ÙˆØ§Ù†ÛŒÙ†: Ø§Ø¹Ø¯Ø§Ø¯ Ú©ÙˆÚ†Ú©ØªØ± Ø§Ø² Û´</div>
      <div class="brace" id="braceB">B = { }</div>
      <div class="set-contents" id="contentsB"></div>
    </div>

    <div class="set-box" data-set="C" id="boxC">
      <div class="set-header">
        <div class="set-title">C = { }</div>
        <div style="font-size:12px;color:var(--muted)">C</div>
      </div>
      <div class="set-desc">Ù‚ÙˆØ§Ù†ÛŒÙ†: Ø§Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ¬</div>
      <div class="brace" id="braceC">C = { }</div>
      <div class="set-contents" id="contentsC"></div>
    </div>
  </div>

  <div class="tray" id="tray" aria-label="Ø³ÛŒÙ†ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§">
    <!-- cards: duplicates included -->
    <div class="card" draggable="true" data-value="1">Û±</div>
    <div class="card" draggable="true" data-value="2">Û²</div>
    <div class="card" draggable="true" data-value="3">Û³</div>
    <div class="card" draggable="true" data-value="4">Û´</div>
    <div class="card" draggable="true" data-value="5">Ûµ</div>
    <div class="card" draggable="true" data-value="6">Û¶</div>
    <div class="card" draggable="true" data-value="1">Û±</div>
    <div class="card" draggable="true" data-value="2">Û²</div>
  </div>

  <div class="hint">Ù†Ú©ØªÙ‡: Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ù¾Ø³ Ø§Ø² Ø§Ù†Ø¯Ø§Ø®ØªÙ† Ø¯Ø± Ø¨Ø§Ú©Ø³ØŒ Ø¯Ø± Ø³ÛŒÙ†ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯ â€” Ù„Ø§Ø²Ù… Ø§Ø³Øª Ù‡Ù…Ø§Ù† Ú©Ø§Ø±Øª Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” Ù…Ø²Ø¨ÙˆØ± Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø¯Ø± Ø¢Ù† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø±Ù‡Ø§ Ú©Ù†ÛŒ. Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯Ø§Ø´ØªÙ† ÛŒÚ© Ø¹Ø¯Ø¯ Ø§Ø² Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ú©Ø§ÙÛŒØ³Øª Ø±ÙˆÛŒ Ø¢Ù† Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒ.</div>

  <!-- overlay entrance -->
  <div id="overlay" role="dialog" aria-modal="true">
    <div class="curtain">
      <div class="title">Ø¢Ø²Ù…Ø§ÛŒØ´Ù Ù…Ø±Ø­Ù„Ù‡Ù” Û² Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª</div>
      <div class="sub">Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ Ø¨Ø¨ÛŒÙ† Ú©Ù‡ ÛŒÚ© Ø¹Ø¯Ø¯ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù‡Ù…â€ŒØ²Ù…Ø§Ù† Ø¹Ø¶ÙˆÙ Ú†Ù†Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¨Ø§Ø´Ø¯. ÙˆÙ‚ØªÛŒ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒØŒ Ú©Ù„ÛŒØ¯ Ø±Ø§ ÙØ´Ø§Ø± Ø¨Ø¯Ù‡ ØªØ§ ÙˆØ§Ø±Ø¯ Ø¨Ø§Ø²ÛŒ Ø´ÙˆÛŒ.</div>

      <div class="keyWrap" id="keyWrap">
        <button class="key" id="enterKey">ğŸ”‘ Ø¨Ø§Ø² Ú©Ù† Ø¯Ø±Ù Ø¢Ø²Ù…Ø§ÛŒØ´</button>
      </div>
    </div>
  </div>

<script>
/* ---------- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¬Ù…ÙˆØ¹Ù‡ (ØªØ¹Ø§Ø±ÛŒÙ Ø±ÛŒØ§Ø¶ÛŒâ€ŒØ§ÛŒ) ---------- */
const setsDef = {
  A: (n) => n % 2 === 1,          // ÙØ±Ø¯
  B: (n) => n < 4,                // Ú©ÙˆÚ†Ú©ØªØ± Ø§Ø² 4
  C: (n) => n % 2 === 0           // Ø²ÙˆØ¬
};

/* Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ */
const tray = document.getElementById('tray');
const boxes = {
  A: document.getElementById('boxA'),
  B: document.getElementById('boxB'),
  C: document.getElementById('boxC')
};
const contents = {
  A: document.getElementById('contentsA'),
  B: document.getElementById('contentsB'),
  C: document.getElementById('contentsC')
};
const braces = {
  A: document.getElementById('braceA'),
  B: document.getElementById('braceB'),
  C: document.getElementById('braceC')
};

/* state: track which numbers are in which set (use arrays to preserve order, and unique) */
const setMembers = { A: [], B: [], C: [] };

/* helper: update brace text from setMembers */
function updateBraces(){
  for(const k of ['A','B','C']){
    const arr = setMembers[k];
    braces[k].textContent = `${k} = { ${arr.join(arr.length? ', ' : '')}${arr.join(', ')} }`.replace(',  }',' }').replace('{  }','{ }');
    // simpler: handle empty nicely
    if(arr.length === 0) braces[k].textContent = `${k} = { }`;
    else braces[k].textContent = `${k} = { ${arr.join(', ')} }`;
  }
}

/* helper: add chip to set (only if not already present) */
function addToSet(setName, value){
  const v = Number(value);
  if(setMembers[setName].includes(v)) return false; // already there
  setMembers[setName].push(v);
  renderSetChips(setName);
  updateBraces();
  // small pulse on box
  const box = boxes[setName];
  box.classList.add('flashPulse');
  setTimeout(()=> box.classList.remove('flashPulse'), 700);
  return true;
}

/* helper: remove chip by element click */
function removeFromSet(setName, value){
  const v = Number(value);
  setMembers[setName] = setMembers[setName].filter(x => x !== v);
  renderSetChips(setName);
  updateBraces();
}

/* render chips inside set */
function renderSetChips(setName){
  const el = contents[setName];
  el.innerHTML = '';
  setMembers[setName].forEach(val=>{
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.textContent = val;
    // click to remove
    chip.addEventListener('click', ()=> {
      removeFromSet(setName, val);
    });
    el.appendChild(chip);
  });
}

/* make tray cards draggable */
function setupTrayCard(card){
  card.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', card.dataset.value);
    e.dataTransfer.setData('origin','tray');
    e.dataTransfer.setData('dragId', '');
    // visual hint
    card.classList.add('fade');
    setTimeout(()=> card.classList.remove('fade'), 320);
  });
  // touch / click friendly: small pop
  card.addEventListener('click', ()=> {
    card.animate([{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:160});
  });
}

/* initialize tray */
Array.from(tray.querySelectorAll('.card')).forEach(setupTrayCard);

/* make sets accept drops */
Object.keys(boxes).forEach(setName=>{
  const box = boxes[setName];
  box.addEventListener('dragover', e=> e.preventDefault());
  box.addEventListener('drop', e=>{
    e.preventDefault();
    const value = Number(e.dataTransfer.getData('value'));
    const origin = e.dataTransfer.getData('origin'); // tray
    // membership test
    if(setsDef[setName](value)){
      // allowed: add to set (but do NOT remove tray card â€” in stage2 tray keeps originals)
      const added = addToSet(setName, value);
      if(added){
        // create a small placed chip (already rendered by renderSetChips), optional sound/animation here
      } else {
        // already present: subtle shake
        box.classList.add('shake');
        setTimeout(()=> box.classList.remove('shake'), 380);
      }
    } else {
      // not a member: do nothing except gentle shake and return (no harsh error)
      box.classList.add('shake');
      setTimeout(()=> box.classList.remove('shake'), 380);
      // additionally a small flash of red border
      const old = box.style.borderColor;
      box.style.borderColor = 'rgba(255,107,107,0.6)';
      setTimeout(()=> box.style.borderColor = 'rgba(125,211,252,0.06)', 420);
    }
    // ensure any tray card visuals restored
    const dragId = e.dataTransfer.getData('dragId');
    if(dragId){
      const t = document.getElementById(dragId);
      if(t){ t.classList.remove('fade'); }
    }
  });
});

/* also allow dropping outside to "cancel" (no action) */
document.body.addEventListener('dragover', e=> e.preventDefault());
document.body.addEventListener('drop', e=>{
  // if drop on background â€” do nothing; tray cards were never removed so nothing to restore
  e.preventDefault();
});

/* update braces initially */
updateBraces();

/* entrance overlay logic */
const overlay = document.getElementById('overlay');
const keyWrap = document.getElementById('keyWrap');
setTimeout(()=> keyWrap.classList.add('show'), 650);
document.getElementById('enterKey').addEventListener('click', ()=>{
  // play a small animation: fade out overlay
  overlay.style.transition = 'opacity .42s ease, transform .42s ease';
  overlay.style.opacity = '0';
  overlay.style.transform = 'scale(.98)';
  setTimeout(()=> overlay.style.display = 'none', 460);
});

/* keyboard accessibility: Esc to close overlay */
document.addEventListener('keydown', e=>{
  if(e.key === 'Escape' && overlay.style.display !== 'none'){
    overlay.style.display = 'none';
  }
});

/* optional: touch support for mobile (dragstart already handles most) */
/* No error messages pop â€” per spec */

/* ensure braces stay in requested format (English letter then = then braces) already implemented above */

/* small helper: clicking a chip removes it (done in render); ensure braces update â€” done */

</script>
</body>
</html>
